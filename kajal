@app.patch("/drafts/{draft_id}/complete/")
def mark_as_complete(draft_id: int, db: Session = Depends(get_db)):
    draft = db.query(DraftTable).filter(DraftTable.id == draft_id).first()
    if not draft:
        raise HTTPException(status_code=404, detail="Draft not found")
    draft.is_complete = True
    db.commit()
    return {"message": "Draft marked as complete"}

@app.post("/promote/{draft_id}/")
def promote_to_master(draft_id: int, db: Session = Depends(get_db)):
    draft = db.query(DraftTable).filter(DraftTable.id == draft_id, DraftTable.is_complete == True).first()
    if not draft:
        raise HTTPException(status_code=404, detail="Draft not found or incomplete")
    new_master = MasterTable(data=draft.data)
    db.add(new_master)
    db.delete(draft)  # Remove draft after promotion
    db.commit()
    return {"message": "Draft promoted to master table", "master_id": new_master.id}
